---
title: "3.9.1.1.\tCódigo clustering con la distancia euclidiana"
author: "Teresa Gual"
date: "2025-03-27"
output: html_document
---


```{r}
#Create the matrix of the 27 vectors in R corresponding to SDG 2 for the 27 European countries

ODS2 <- matrix(c(
  68, 68, 68, 70, 71, 70, 70, 70, 70, 69, 69, 69, 69, 68, 66, 66, 65, 65, 65, 64, 64, 64, 64, 64,
  38, 37, 37, 39, 40, 40, 40, 41, 41, 42, 41, 41, 41, 41, 42, 43, 43, 43, 43, 43, 43, 43, 43, 43,
  52, 53, 52, 52, 51, 50, 51, 52, 52, 52, 52, 51, 51, 52, 48, 49, 49, 49, 49, 50, 50, 50, 50, 50,
  46, 45, 43, 46, 46, 49, 48, 47, 44, 44, 43, 43, 44, 44, 45, 51, 48, 49, 50, 48, 47, 46, 46, 46,
  62, 63, 62, 62, 62, 62, 62, 61, 62, 63, 63, 63, 63, 63, 62, 60, 60, 60, 61, 61, 62, 62, 62, 62,
  61, 61, 61, 60, 61, 61, 60, 60, 60, 60, 60, 60, 60, 60, 59, 59, 59, 59, 60, 59, 60, 60, 60, 60,
  64, 64, 67, 66, 66, 64, 65, 65, 65, 66, 66, 66, 67, 66, 65, 64, 64, 64, 64, 64, 63, 65, 65, 65,
  53, 52, 53, 52, 53, 54, 54, 53, 54, 54, 53, 53, 53, 53, 53, 53, 53, 54, 54, 53, 53, 53, 53, 53,
  59, 59, 56, 57, 58, 58, 58, 59, 57, 58, 59, 59, 58, 58, 54, 54, 54, 53, 53, 53, 53, 53, 53, 53,
  44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 43, 43, 43, 43, 43, 43, 43,
  64, 64, 64, 64, 65, 65, 64, 65, 65, 65, 65, 65, 65, 65, 63, 63, 63, 62, 63, 63, 63, 63, 63, 63,
  61, 63, 62, 61, 62, 62, 60, 60, 62, 63, 61, 63, 63, 63, 63, 63, 62, 63, 63, 63, 63, 63, 63, 63,
  66, 65, 65, 65, 62, 62, 61, 61, 60, 64, 63, 62, 61, 63, 62, 63, 67, 66, 66, 63, 63, 63, 63, 63,
  65, 65, 65, 65, 66, 66, 66, 65, 66, 67, 65, 66, 66, 66, 65, 64, 63, 64, 64, 61, 60, 60, 60, 60,
  62, 62, 64, 63, 62, 63, 64, 64, 65, 65, 65, 65, 65, 65, 64, 62, 63, 66, 65, 66, 66, 66, 66, 66,
  58, 57, 57, 57, 58, 58, 57, 57, 56, 57, 57, 56, 56, 56, 57, 57, 57, 57, 57, 57, 57, 57, 57, 57,
  60, 59, 58, 59, 58, 58, 57, 57, 56, 56, 56, 57, 57, 57, 56, 57, 57, 56, 56, 55, 55, 55, 55, 55,
  58, 56, 57, 57, 56, 56, 57, 57, 57, 57, 57, 57, 57, 57, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59,
  62, 63, 62, 62, 62, 63, 62, 61, 60, 60, 60, 60, 62, 62, 60, 59, 59, 58, 58, 57, 57, 57, 57, 57,
  33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 33, 34, 33, 34, 34, 32, 32, 32, 32, 32,
  35, 35, 35, 35, 35, 35, 35, 36, 35, 35, 35, 35, 35, 36, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35,
  61, 61, 60, 60, 61, 61, 61, 61, 61, 61, 60, 60, 60, 60, 60, 60, 60, 60, 59, 58, 58, 59, 59, 59,
  51, 51, 51, 52, 53, 52, 51, 51, 51, 51, 52, 51, 52, 51, 51, 51, 50, 51, 51, 50, 50, 50, 50, 50,
  68, 68, 67, 67, 67, 66, 66, 65, 65, 65, 67, 67, 67, 68, 66, 66, 66, 65, 66, 65, 65, 65, 65, 65,
  66, 65, 65, 65, 65, 64, 65, 65, 66, 65, 65, 65, 66, 64, 63, 63, 61, 62, 62, 58, 59, 59, 59, 59,
  55, 53, 53, 54, 55, 55, 54, 54, 54, 53, 54, 54, 55, 56, 54, 54, 54, 56, 56, 53, 54, 53, 53, 53,
  65, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 65, 65, 65, 65, 65
), nrow = 27, byrow = TRUE)

```

Calculate and visualize the Silhouette Score

```{r}
install.packages("factoextra")  
library(factoextra)

fviz_nbclust(ODS2, kmeans, method = "silhouette") +
  labs(subtitle = "Método de la silueta ODS2")
```
# 2. K-means clustering
```{r}
set.seed(123)
kmeans_result <- kmeans(ODS2, centers = 2)
```

3. Visualization
```{r}
library(cluster)
clusplot(ODS2, kmeans_result$cluster, color = TRUE, shade = TRUE, labels = 2, lines = 0)
```
4. Results
```{r}
print(kmeans_result)
```

